;
(self.AMP=self.AMP||[]).push({m:0,v:"2510081644000",n:"amp-skimlinks",ev:"0.1",l:!0,f:function(t,n){!function(){function n(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function i(t,n){return(i=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&i(t,n)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=u(t);if(n){var e=u(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return o(this,i)}}var c="load-start",a=Array.isArray;function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}var h,l=Object.prototype;function v(t){var n=Object.create(null);return t&&Object.assign(n,t),n}function d(t){return(t.ownerDocument||t).defaultView}function p(t,n){return t.replace(/^|,/g,"$&".concat(n," "))}function m(t,n,i){return function(t,n){for(var i in n)t.setAttribute(i,n[i]);return t}(t.createElement(n),i)}l.hasOwnProperty,l.toString,self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b,w=self.__AMP_LOG;function k(t,n){throw new Error("failed to call initLogConstructor")}function y(t){return k()}function g(){return w.dev||(w.dev=k())}function j(t,n,i,r,u,e,o,s,c,a,f){return t}function O(t,n,i,r,u,e,o,s,c,a,f){return(w.user||(w.user=y()),void w.user.win?w.userForEmbed||(w.userForEmbed=y()):w.user).assert(t,n,i,r,u,e,o,s,c,a,f)}function S(){return b||(b=Promise.resolve(void 0))}var N=function(){var t=this;this.promise=new Promise((function(n,i){t.resolve=n,t.reject=i}))};function I(t,n){return R(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function U(t,n){return R(E(A(t)),n)}function x(t,n){return function(t,n){var i=C(t,n);if(i)return i;var r,u,e,o,s=D(t);return s[n]=(u=(r=new N).promise,e=r.reject,o=r.resolve,u.catch((function(){})),{obj:null,promise:u,resolve:o,reject:e,context:null,ctor:null}),s[n].promise}(E(t),n)}function T(t,n){return C(E(t),n)}function A(t){return t.nodeType?(n=d(t),I(n,"ampdoc")).getAmpDoc(t):t;var n}function E(t){var n=A(t);return n.isSingleDoc()?n.win:n}function R(t,n){j(function(t,n){var i=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!i||!i.ctor)}(t,n));var i=D(t)[n];return i.obj||(j(i.ctor),j(i.context),i.obj=new i.ctor(i.context),j(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}function C(t,n){var i=D(t)[n];return i?i.promise?i.promise:(R(t,n),i.promise=Promise.resolve(i.obj)):null}function D(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var P,J,L=function(t){return A(t)},$=function(t){return function(t,n,i,r){var u=T(t,n);if(u)return u;var e=A(t);return e.whenExtensionsKnown().then((function(){var t=e.getExtensionVersion(i);return t?I(e.win,"extensions").waitForExtension(i,t):null})).then((function(i){return i?x(t,n):null}))}(t,"amp-analytics-instrumentation","amp-analytics")},M=function(t){return U(t,"documentInfo").get()},z=function(t){return I(t,"extensions")},q=function(t,n){this.syncResponse=t,this.asyncResponse=n},B=function(){function t(t){this.St=t,this.Et=0,this.Rt=0,this.xt=v()}var n=t.prototype;return n.has=function(t){return!!this.xt[t]},n.get=function(t){var n=this.xt[t];if(n)return n.access=++this.Rt,n.payload},n.put=function(t,n){this.has(t)||this.Et++,this.xt[t]={payload:n,access:this.Rt},this.Tt()},n.Tt=function(){if(!(this.Et<=this.St)){var t,n=this.xt,i=this.Rt+1;for(var r in n){var u=n[r].access;u<i&&(i=u,t=r)}void 0!==t&&(delete n[t],this.Et--)}},t}();function F(){for(var t="",n=0;n<8;n++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}function _(t){return function(t,n){return P||(P=self.document.createElement("a"),J=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new B(100))),function(t,n,i){if(i&&i.has(n))return i.get(n);t.href=n,t.protocol||(t.href=t.href);var r,u={href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:"0"==t.port?"":t.port,pathname:t.pathname,search:t.search,hash:t.hash,origin:null};"/"!==u.pathname[0]&&(u.pathname="/"+u.pathname),("http:"==u.protocol&&80==u.port||"https:"==u.protocol&&443==u.port)&&(u.port="",u.host=u.hostname),r=t.origin&&"null"!=t.origin?t.origin:"data:"!=u.protocol&&u.host?u.protocol+"//"+u.host:u.href,u.origin=r;var e=u;return i&&i.put(n,e),e}(P,t,J)}(t).hostname.replace(/^www\./,"")}function G(t){return t?t.hostname.replace(/^www\./,""):""}function K(t,n){var i=n.excludedDomains;return i&&-1!==i.indexOf(t)}function Z(t,n){return K(G(t),n)}var H="affiliate",W="ignore",Q="unknown",V=function(){function t(t,n,i){this.dt=t,this.kU=n,this.jU=i,this.OU={},this.firstRequest=null}var n=t.prototype;return n.fetchDomainResolverApi=function(t){var n={"pubcode":this.kU.pubcode,"page":"","domains":t},i=this.kU.config.beaconUrl;return i="".concat(i,"?data=").concat(JSON.stringify(n)),this.dt.fetchJson(i,{method:"GET",ampCors:!1,credentials:"include"}).then((function(t){return t.json()}))},n.resolveUnknownAnchors=function(t){var n=this.SU(t),i=null,r=this.NU(t);if(r.length){this.IU(r);var u=this.UU(t,r);i=this.xU(u,r)}return new q(n,i)},n.SU=function(t){var n=this;return t.map((function(t){var i=null,r=n.TU(n.EU(t));return(r===H||r===Q)&&(i=n.jU.getAffiliateUrl(t)),{anchor:t,replacementUrl:i}}))},n.TU=function(t){return K(t,this.kU)?W:this.OU[t]||Q},n.NU=function(t){var n=this;return t.reduce((function(t,i){var r=n.EU(i),u=n.OU[r],e=K(r,n.kU),o=-1!==t.indexOf(r);return u||e||o||t.push(r),t}),[])},n.IU=function(t){var n=this;t.forEach((function(t){n.OU[t]||(K(t,n.kU)&&(n.OU[t]=W),n.OU[t]=Q)}))},n.UU=function(t,n){var i=this;return t.filter((function(t){var r=i.EU(t);return-1!==n.indexOf(r)}))},n.xU=function(t,n){var i=this,r=this.fetchDomainResolverApi(n);return this.firstRequest||(this.firstRequest=r),r.then((function(r){var u=r.merchant_domains||[];return i.RU(n,u),i.SU(t)}))},n.RU=function(t,n){var i=this;t.forEach((function(t){var r=-1!==n.indexOf(t);i.OU[t]=r?H:"non-affiliate"}))},n.EU=function(t){return G(t)},t}(),X="data-skimlinks-custom-tracking-id",Y="amp@1.0.3",tt="amp-skimlinks",nt="https://t.skimresources.com/api",it={pageTrackingUrl:"".concat(nt,"/track.php?data=${data}"),linksTrackingUrl:"".concat(nt,"/link?data=${data}"),nonAffiliateTrackingUrl:"".concat(nt,"/?call=track&rnd=${rnd}&data=${data}"),beaconUrl:"https://r.skimresources.com/api"},rt=["facebook.com","go.redirectingat.com","go.skimresources.com","instagram.com","twitter.com","youtube.com"],ut="PAGE_SCANNED",et="CLICK",ot="data-link-rewriter-original-url";var st=function(){function t(){this.Ur=[]}var n,i=t.prototype;return i.peek=function(){var t=this.length;return t?this.Ur[t-1].item:null},i.enqueue=function(t,n){if(isNaN(n))throw new Error("Priority must not be NaN.");var i=this.zr(n);this.Ur.splice(i,0,{item:t,priority:n})},i.zr=function(t){for(var n=-1,i=0,r=this.length;i<=r&&(n=Math.floor((i+r)/2))!==this.length;)if(this.Ur[n].priority<t)i=n+1;else{if(!(n>0&&this.Ur[n-1].priority>=t))break;r=n-1}return n},i.forEach=function(t){for(var n=this.length;n--;)t(this.Ur[n].item)},i.dequeue=function(){var t=this.Ur.pop();return t?t.item:null},(n=[{key:"length",get:function(){return this.Ur.length}}])&&function(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,n),t}();function ct(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,r)}return i}function at(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?ct(Object(r),!0).forEach((function(i){n(t,i,r[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}var ft,ht=function(){function t(){this.xn=null}var n=t.prototype;return n.add=function(t){var n=this;return this.xn||(this.xn=[]),this.xn.push(t),function(){n.remove(t)}},n.remove=function(t){var n,i,r;this.xn&&(i=t,-1!=(r=(n=this.xn).indexOf(i))&&n.splice(r,1))},n.removeAll=function(){this.xn&&(this.xn.length=0)},n.fire=function(t){if(this.xn)for(var n,i=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return f(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(t,n):void 0}}(t))||t&&"number"==typeof t.length){i&&(t=i);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.xn.slice());!(n=i()).done;)(0,n.value)(t)},n.getHandlerCount=function(){var t,n;return null!==(t=null===(n=this.xn)||void 0===n?void 0:n.length)&&void 0!==t?t:0},t}(),lt=function(){function t(){this.CU=[],this.DU=[]}var n=t.prototype;return n.updateLinkList=function(t){this.DU=t.map(this.getReplacementUrlForAnchor.bind(this)),this.CU=t},n.updateReplacementUrls=function(t){var n=this;t.forEach((function(t){var i=t.anchor,r=t.replacementUrl,u=n.CU.indexOf(i);-1!==u&&(n.DU[u]=r)}))},n.getReplacementUrlForAnchor=function(t){var n=this.CU.indexOf(t);return-1!==n?this.DU[n]:null},n.isInCache=function(t){return-1!==this.CU.indexOf(t)},n.getAnchorReplacementList=function(){var t=this;return this.CU.map((function(n){return{anchor:n,replacementUrl:t.getReplacementUrlForAnchor(n)}}))},t}(),vt=["Webkit","webkit","Moz","moz","ms","O","o"];function dt(t,n,i,r,u){var e=function(t,n,i){if(n.startsWith("--"))return n;ft||(ft=v());var r=ft[n];if(!r||i){if(r=n,void 0===t[n]){var u=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),e=function(t,n){for(var i=0;i<vt.length;i++){var r=vt[i]+n;if(void 0!==t[r])return r}return""}(t,u);void 0!==t[e]&&(r=e)}i||(ft[n]=r)}return r}(t.style,n,u);if(e){var o,s=r?i+r:i;t.style.setProperty((o=e.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()})),vt.some((function(t){return o.startsWith(t+"-")}))?"-".concat(o):o),s)}}var pt=!1,mt="CHUNK",bt=/nochunking=1/.test(self.location.hash),wt=S();var kt="not_run",yt=function(){function t(t){this.state=kt,this.Hr=t}var n=t.prototype;return n.Gr=function(t){if("run"!=this.state){this.state="run";try{this.Hr(t)}catch(t){throw this.Vr(t),t}}},n.Fr=function(){return this.Hr.displayName||this.Hr.name},n.Vr=function(t){},n.Br=function(){return!1},n.qr=function(){return!1},t}(),gt=function(t){r(i,t);var n=s(i);function i(t,i,r){var u;return(u=n.call(this,t)).$r=r,u}var u=i.prototype;return u.Vr=function(t){var n;j((n=self.document).defaultView),pt||(pt=!0,function(t){!function(t,n){for(var i in n)dt(t,i,n[i])}(t.body,{opacity:1,visibility:"visible","animation":"none"})}(n))},u.Br=function(){return this.Wr()},u.qr=function(){return this.$r.Kr},u.Wr=function(){return this.$r.ampdoc.isVisible()},i}(yt),jt=function(){function t(t){var n,i=this;this.ampdoc=t,this.t=t.win,this.Yr=new st,this.Jr=this.Xr.bind(this),this.Qr=0,this.Zr=!(!this.t.navigator.scheduling||!this.t.navigator.scheduling.isInputPending),this.Ae=!1,this.Lr=this.t.document.documentElement.hasAttribute("i-amphtml-no-boilerplate"),this.t.addEventListener("message",(function(t){"amp-macro-task"==t.data&&i.Xr(null)})),this.Kr=!1,(n=t,x(n,"viewer")).then((function(){i.Kr=!0})),t.onVisibilityChanged((function(){t.isVisible()&&i.Ee()}))}var n=t.prototype;return n.run=function(t,n){var i=new yt(t);this.Oe(i,n)},n.runForStartup=function(t){var n=new gt(t,this.t,this);this.Oe(n,Number.POSITIVE_INFINITY)},n.Oe=function(t,n){this.Yr.enqueue(t,n),this.Ee()},n.Te=function(t){for(var n=this.Yr.peek();n&&n.state!==kt;)this.Yr.dequeue(),n=this.Yr.peek();return n&&t&&this.Yr.dequeue(),n},n.Xr=function(t){var n,i=this,r=this.Te(!0);if(!r)return this.Ae=!1,this.Qr=0,!1;try{n=Date.now(),r.Gr(t)}finally{wt.then().then().then().then().then().then().then().then().then((function(){i.Ae=!1,i.Qr+=Date.now()-n,g().fine(mt,r.Fr(),"Chunk duration",Date.now()-n,i.Qr),i.Ee()}))}return!0},n.Pe=function(t){var n=this;if(this.Lr&&(this.Zr?this.t.navigator.scheduling.isInputPending():this.Qr>5))return this.Qr=0,void this.Se();wt.then((function(){n.Jr(t)}))},n.Ee=function(){if(!this.Ae){var t=this.Te();if(t)return t.Br()?(this.Ae=!0,void this.Pe(null)):void(t.qr()&&this.t.requestIdleCallback?(n=this.t,i=2e3,r=this.Jr,u=Date.now(),n.requestIdleCallback((function t(e){if(e.timeRemaining()<15){var o=i-(Date.now()-u);o<=0||e.didTimeout?(g().fine(mt,"Timed out",i,e.didTimeout),r(e)):(g().fine(mt,"Rescheduling with",o,e.timeRemaining()),n.requestIdleCallback(t,{timeout:o}))}else g().fine(mt,"Running idle callback with ",15),r(e)}),{timeout:i})):this.Se())}var n,i,r,u},n.Se=function(){this.t.postMessage("amp-macro-task","*")},t}(),Ot=function(){function t(t,n,i,r){this.events=new ht,this.id=n,this.ju=t,this.PU=i,this.JU=r.linkSelector||"a",this.LU=300,this.$U=new lt}var n=t.prototype;return n.getReplacementUrl=function(t){return this.isWatchingLink(t)?this.$U.getReplacementUrlForAnchor(t):null},n.getAnchorReplacementList=function(){return this.$U.getAnchorReplacementList()},n.isWatchingLink=function(t){return this.$U.isInCache(t)},n.rewriteAnchorUrl=function(t){var n=this.getReplacementUrl(t);return!(!n||n===t.href||(t.setAttribute(ot,t.href),t.href=n,setTimeout((function(){t.href=t.getAttribute(ot),t.removeAttribute(ot)}),this.LU),0))},n.onDomUpdated=function(){var t=this;return new Promise((function(n){!function(t,n,i){if(bt)wt.then(n);else{var r=function(t){return n="chunk",i=jt,function(t,n,i,r,u,e){var o=D(t),s=o[i];s||(s=o[i]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),s.ctor||(s.ctor=r,s.context=n,s.sharedInstance=!1,s.resolve&&R(t,i))}(E(r=A(t)),r,n,i),U(t,"chunk");var n,i,r}(t);r.run(n,i)}}(t.ju.nodeType==Node.DOCUMENT_NODE?t.ju.documentElement:t.ju,(function(){return t.MU().then((function(){t.events.fire({type:ut}),n()}))}),10)}))},n.MU=function(){var t=this,n=this.zU(),i=this.UU(n);if(this.$U.updateLinkList(n),!i.length)return S();this.$U.updateReplacementUrls(i.map((function(t){return{anchor:t,replacementUrl:null}})));var r=this.PU(i);return O(r instanceof q,'Invalid response from provided "resolveUnknownLinks" function."resolveUnknownLinks" should return an instance of TwoStepsResponse'),r.syncResponse&&this.$U.updateReplacementUrls(r.syncResponse),r.asyncResponse?r.asyncResponse.then((function(n){t.$U.updateReplacementUrls(n)})):S()},n.UU=function(t){var n=this,i=[];return t.forEach((function(t){n.isWatchingLink(t)||i.push(t)})),i},n.zU=function(){var t=this.ju.querySelectorAll(this.JU);return[].slice.call(t)},t}(),St=function(){function t(t){var n;this.ju=t.getRootNode(),this.qU=this.BU(t),this.FU=[],this._U(this.ju),(n=t,U(n,"navigation")).registerAnchorMutator(this.maybeRewriteLink.bind(this),0)}var n=t.prototype;return n.registerLinkRewriter=function(t,n,i){var r=new Ot(this.ju,t,n,i);return this.GU(this.FU,r,this.qU),r.onDomUpdated(),r},n.maybeRewriteLink=function(t,n){var i=this.KU(t);if(i.length){for(var r=null,u=0;u<i.length;u++)if(i[u].rewriteAnchorUrl(t)){r=i[u];break}var e={linkRewriterId:r?r.id:null,anchor:t,clickType:n.type};i.forEach((function(t){var n={type:et,eventData:e};t.events.fire(n)}))}},n.BU=function(t){var n=t.getMetaByName("amp-link-rewriter-priorities");return n?n.trim().split(/\s+/):[]},n._U=function(t){t.addEventListener("amp:dom-update",this.ZU.bind(this))},n.ZU=function(){this.FU.forEach((function(t){t.onDomUpdated()}))},n.HU=function(t){var n=t.hasAttribute("data-link-rewriters")?t.getAttribute("data-link-rewriters").trim():null;return n?n.split(/\s+/):[]},n.GU=function(t,n,i){return t.push(n),t.sort((function(t,n){var r=i.indexOf(t.id),u=i.indexOf(n.id);return-1===r&&-1===u?0:-1===r?1:-1===u?-1:r>u?1:-1})),t},n.KU=function(t){var n=this,i=this.HU(t);return this.FU.reduce((function(r,u){return u.isWatchingLink(t)&&n.GU(r,u,i),r}),[])},t}();function Nt(t,n){O(t,"<amp-skimlinks> Invalid option => ".concat(n))}function It(t,n){var i=[].concat(n).concat(rt),r=t.getAttribute("excluded-domains");return r&&(i=i.concat(r.trim().split(/\s+/).map((function(t){return t.replace(/^www\./,"")})))),i}function Ut(t){var n=t.getAttribute("publisher-code");return Nt(n,'"publisher-code" is required.'),n}function xt(t){var n=t.getAttribute("tracking");return!n||(Nt("true"===n||"false"===n,'"tracking" possible values are "true" or "false".'),"true"===n)}function Tt(t){var n=t.getAttribute("custom-tracking-id");return n&&Nt(n.length<=50,'"custom-tracking-id" should be <=50 characters and only contain upper and lowercase characters, numbers, underscores and pipes.'),n}function At(t){return t.getAttribute("link-selector")||null}function Et(t){var n=[];return t.canonicalUrl&&n.push(_(t.canonicalUrl)),t.sourceUrl&&n.push(_(t.sourceUrl)),n}function Rt(t){var n=t.getAttribute("custom-redirect-domain");return n?(n=n.replace(/^\/\/|^https?:\/\/|\/$/g,""),"http://".concat(n)):"https://go.skimresources.com"}function Ct(t){try{var n=function(t){var n,i,r,u,e=(n=t,/^[\w-]+$/.test(i="script"),r=n,u="> ".concat(i),(void 0!==h?h:h=function(t){try{var n=t.ownerDocument,i=n.createElement("div"),r=n.createElement("div");return i.appendChild(r),i.querySelector(":scope div")===r}catch(t){return!1}}(r))?r.querySelectorAll(p(u,":scope")):function(t,n){var i=t.classList,r="i-amphtml-scoped";i.add(r);var u=p(n,".".concat(r)),e=t.querySelectorAll(u);return i.remove(r),e}(r,u)),o=e.length;if(1!==o)throw new Error("Found ".concat(o," <script> children. Expected 1."));var s,c=e[0];if(!function(t){var n;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(n=t.getAttribute("type"))||void 0===n?void 0:n.toUpperCase())}(c))throw new Error('<script> child must have type="application/json"');try{var a;return s=null!==(a=c.textContent)&&void 0!==a?a:"",JSON.parse(s)}catch(t){throw new Error("Failed to parse <script> contents. Is it valid JSON?")}}(t);return{pageTrackingUrl:n.pageTrackingUrl||it.pageTrackingUrl,linksTrackingUrl:n.linksTrackingUrl||it.linksTrackingUrl,nonAffiliateTrackingUrl:n.nonAffiliateTrackingUrl||it.nonAffiliateTrackingUrl,beaconUrl:n.beaconUrl||it.beaconUrl}}catch(t){return it}}var Dt=function(){function t(t,n){var i=this;for(var r in j(n.triggers),this.Ti=t.getResourceId(),this.ei=t,this.vk=n,n.triggers){var u=n.triggers[r].on;j(u);var e=this.WU(u);n.triggers[r].on=e}this.ei.signals().whenSignal(c).then((function(){!function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=t.ownerDocument,e=m(u,"amp-analytics",{"sandbox":"true","trigger":r?"":"immediate"}),o=m(u,"script",{"type":"application/json"});if(o.textContent=JSON.stringify(n),e.appendChild(o),e.CONFIG=n,i){var s=z(d(t)),c=L(t);s.installExtensionForDoc(c,"amp-analytics")}else $(t).then((function(t){j(t)}));t.appendChild(e)}(i.ei,n,!0)}))}var n=t.prototype;return n.trigger=function(t,n){j(this.vk.triggers[t]),function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];$(t).then((function(u){u&&u.triggerEventForTarget(t,n,i,r)}))}(this.ei,this.WU(t),n,!1)},n.WU=function(t){return"sandbox-".concat(this.Ti,"-").concat(t)},t}(),Pt=function(){function t(t){this.ei=t,this.vk={"requests":{},"triggers":{}}}var n=t.prototype;return n.setTransportConfig=function(t){this.vk.transport=t},n.setExtraUrlParams=function(t){this.vk.extraUrlParams=t},n.track=function(t,n){n=a(n)?n:[n],j(!this.vk.triggers[t]);for(var i=[],r=0;r<n.length;r++){var u="".concat(t,"-request-").concat(r);this.vk.requests[u]=n[r],i.push(u)}return this.vk.triggers[t]={"on":t,"request":i},this},n.build=function(){j(this.vk);var t=new Dt(this.ei,this.vk);return this.vk=null,t},t}(),Jt="page-impressions",Lt="link-impressions",$t="non-affiliate-click",Mt=function(){function t(t,n,i){this.Xd=n.tracking,this.QU={customTrackingId:n.customTrackingId,guid:null,pageImpressionId:F(),pageUrl:"CANONICAL_URL",pubcode:n.pubcode,referrer:i,timezone:"TIMEZONE"},this.kU=n,this.VU=this.XU(t)}var n=t.prototype;return n.getTrackingInfo=function(){return this.QU},n.setTrackingInfo=function(t){Object.assign(this.QU,t)},n.sendImpressionTracking=function(t){if(this.Xd){var n=this.QU,i=n.guid,r=n.pageImpressionId,u=n.pageUrl,e={"pub":n.pubcode,"pag":u,"guid":i,"uuid":r,"tz":n.timezone,"jv":Y},o=this.YU(t),s=o.numberAffiliateLinks,c=o.urls;this.WC(e,s),this.QC(e,s,c)}},n.sendNaClickTracking=function(t){if(this.Xd&&!Z(t,this.kU)){var n=this.QU,i=n.customTrackingId,r=n.pageImpressionId,u=n.pageUrl,e=n.pubcode,o=n.referrer,s=n.timezone,c={"pubcode":e,"referrer":u,"pref":o,"site":"false","url":t.href,"custom":t.getAttribute(X)||i,"xtz":s,"uuid":r,"product":"1","jv":Y};this.VU.trigger($t,{"data":JSON.stringify(c),"rnd":"RANDOM"})}},n.WC=function(t,n){var i=this.QU,r=i.customTrackingId,u=at({"slc":n,"jsl":0,"pref":i.referrer,"uc":r,"t":1},t);this.VU.trigger(Jt,{"data":JSON.stringify(u)})},n.QC=function(t,n,i){if(0!==n){var r=at({"dl":i,"hae":n?1:0,"typ":"l"},t);this.VU.trigger(Lt,{"data":JSON.stringify(r)})}},n.XU=function(t){var n=new Pt(t),i=this.kU.config,r=i.linksTrackingUrl,u=i.nonAffiliateTrackingUrl,e=i.pageTrackingUrl;return n.track(Jt,e),n.track(Lt,r),n.track($t,u),n.setTransportConfig({"beacon":!0,"image":!0,"xhrpost":!1}),n.build()},n.YU=function(t){var n=this,i=0,r={};return t.forEach((function(t){var u=t.anchor,e=t.replacementUrl,o=Z(u,n.kU);Boolean(e)&&!o&&(r[u.href]=r[u.href]||{"ae":1,"count":0},r[u.href].count+=1,i+=1)})),{numberAffiliateLinks:i,urls:r}},t}(),zt=function(){function t(t,n,i,r){this.Xd=i,this.VC=r,this.XC=M(t).canonicalUrl,this.YC="".concat((new Date).getTimezoneOffset()),this.kU=n}return t.prototype.getAffiliateUrl=function(t){if(!t)return null;var n=this.Xd.getTrackingInfo(),i=n.customTrackingId,r=n.guid,u=n.pageImpressionId,e=n.pubcode,o=t.getAttribute(X)||i,s={"id":e,"url":t.href,"sref":this.XC,"pref":this.VC,"xguid":r,"xuuid":u,"xtz":this.YC,"xs":"1","jv":Y};return o&&(s.xcust=o),function(t,n,i){if(!n)return t;var r=t.split("#",2),u=r[0].split("?",2);return u[0]+(u[1]?"?".concat(u[1],"&").concat(n):"?".concat(n))+(r[1]?"#".concat(r[1]):"")}(this.kU.waypointBaseUrl,function(t){var n,i,r,u=[];for(var e in t){var o=t[e];if(null!=o){o=a(r=o)?r:[r];for(var s=0;s<o.length;s++)u.push((n=e,i=o[s],"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i))))}}return u.join("&")}(s))},t}(),qt=function(t){r(u,t);var i=s(u);function u(t){var n;return(n=i.call(this,t)).dt=null,n.NC=null,n.tD=null,n.fo=null,n.nD=null,n.kU={},n.iD=null,n.rD=null,n.jU=null,n.uD=null,n.UC=null,n}var e=u.prototype;return e.buildCallback=function(){var t,n,i=this;return this.dt=I(this.win,"xhr"),this.NC=this.getAmpDoc(),this.tD=M(this.NC),this.fo=U(this.NC,"viewer"),this.nD=new St(this.NC),this.kU=(t=this.element,n=this.tD,{pubcode:Ut(t),excludedDomains:It(t,Et(n)),tracking:xt(t),customTrackingId:Tt(t),linkSelector:At(t),waypointBaseUrl:Rt(t),config:Ct(t)}),this.NC.waitForBodyOpen().then((function(){return i.fo.getReferrerUrl()})).then((function(t){i.UC=t,i.eD()}))},e.eD=function(){this.iD=this.oD(),this.jU=new zt(this.NC,this.kU,this.iD,this.UC),this.rD=new V(this.dt,this.kU,this.jU),this.uD=this.sD()},e.cD=function(t){var n=this;this.iD.setTrackingInfo({guid:t.guid}),this.NC.whenFirstVisible().then((function(){n.iD.sendImpressionTracking(n.uD.getAnchorReplacementList())}))},e.aD=function(){return(this.rD.firstRequest||this.rD.fetchDomainResolverApi([])).then(this.cD.bind(this))},e.sD=function(){var t,i,r,u,e,o=this,s={linkSelector:this.kU.linkSelector},c=this.nD.registerLinkRewriter(tt,(function(t){return o.rD.resolveUnknownAnchors(t)}),s),a=(n(t={},ut,(i=this.aD.bind(this),r=!1,u=null,e=i,function(){if(!r){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];u=e.apply(self,n),r=!0,e=null}return u})),n(t,et,this.e_.bind(this)),t);return c.events.add((function(t){var n=a[t.type];n&&n(t.eventData)})),c},e.oD=function(){return this.signals().signal(c),new Mt(this.element,this.kU,this.UC)},e.e_=function(t){t.linkRewriterId!==tt&&"contextmenu"!==t.clickType&&this.iD.sendNaClickTracking(t.anchor)},e.isLayoutSupported=function(){return!0},u}(t.BaseElement);t.registerElement("amp-skimlinks",qt)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-skimlinks-0.1.js.map